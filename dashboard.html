<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard | Gobindapur High School</title>
<style>
body{margin:0;font-family:Arial;background:#121212;color:#fff;}
header{background:#0d6efd;padding:10px;text-align:center;font-size:20px;font-weight:bold;}
.container{padding:15px;}
.card{background:#1f1f1f;padding:15px;border-radius:12px;margin-bottom:15px;}
ul{list-style:none;padding:0;}
li{padding:6px 0;}
button{background:#0d6efd;color:#fff;border:none;padding:10px 14px;margin:6px 0;border-radius:12px;cursor:pointer;}
button:hover{background:#0b5ed7;}
.bottom-nav{position:fixed;bottom:0;left:0;width:100%;display:flex;background:#1f1f1f;border-top:1px solid #333;}
.bottom-nav button{flex:1;text-align:center;padding:10px;font-size:14px;}
.bottom-nav button span{display:block;font-size:10px;color:#aaa;}
#fab-admin{position:fixed;bottom:70px;right:20px;background:#0d6efd;padding:15px;border-radius:50%;cursor:pointer;box-shadow:0 6px 12px rgba(0,0,0,.3);}
#admin-student-add{display:none;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:#1f1f1f;padding:20px;border-radius:12px;width:90%;max-width:400px;box-shadow:0 6px 15px rgba(0,0,0,.5);}
#admin-student-add input{width:100%;margin:6px 0;padding:10px;border-radius:8px;border:none;background:#2b2b2b;color:#fff;}
#admin-student-add button{width:100%;margin:6px 0;background:#198754;}
</style>
</head>
<body>

<header>Gobindapur High School</header>

<div class="container">
  <div id="notice" class="card"><h3>Notices</h3><ul id="noticeList"></ul></div>
  <div id="results" class="card"><h3>Results</h3><ul id="resultsList"></ul></div>
  <div id="routine" class="card"><h3>Routine</h3><ul id="routineList"></ul></div>
</div>

<!-- FAB Admin -->
<div id="fab-admin" onclick="toggleAdminForm()">âž•</div>

<!-- Admin Add Student Form -->
<div id="admin-student-add">
  <h3>Add Student</h3>
  <input id="newName" placeholder="Name">
  <input id="newClass" placeholder="Class">
  <input id="newRoll" placeholder="Roll">
  <input id="newSchool" placeholder="School">
  <input id="newUsername" placeholder="Username">
  <input id="newPassword" placeholder="Password">
  <button onclick="addUser()">Add</button>
</div>

<!-- Bottom Navigation -->
<div class="bottom-nav">
  <button onclick="showSection('notice')">ðŸ“¢<span>Notice</span></button>
  <button onclick="showSection('results')">ðŸ“Š<span>Result</span></button>
  <button onclick="showSection('routine')">ðŸ“…<span>Routine</span></button>
</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script>
firebase.initializeApp({
apiKey:"AIzaSyA0loay6NSdcRQJ5q_qWCbvzQW10rgErV4",
databaseURL:"https://gghs-fcfe6-default-rtdb.firebaseio.com"
});
const db=firebase.database();

// check login
let currentUser = JSON.parse(localStorage.getItem("currentUser"));
if(!currentUser){ alert("Please login"); window.location.href="login.html"; }

// toggle admin form
function toggleAdminForm(){
  document.getElementById("admin-student-add").style.display = 
    document.getElementById("admin-student-add").style.display==="none" ? "block":"none";
}

// add student (admin only)
function addUser(){
  db.ref("users").push({
    name: document.getElementById("newName").value,
    class: document.getElementById("newClass").value,
    roll: document.getElementById("newRoll").value,
    school: document.getElementById("newSchool").value,
    username: document.getElementById("newUsername").value,
    password: document.getElementById("newPassword").value
  });
  alert("Student Added");
  toggleAdminForm();
}

// load student-specific notices/results/routine
function loadData(){
  // Notices
  db.ref("notices").once("value").then(s=>{
    let html="";
    s.forEach(c=>{
      html+=`<li>${c.val().text}</li>`;
    });
    document.getElementById("noticeList").innerHTML=html;
  });

  // Results (only current student)
  db.ref("results").once("value").then(s=>{
    let html="";
    s.forEach(c=>{
      let d=c.val();
      if(d.class===currentUser.class && d.roll===currentUser.roll && d.school===currentUser.school){
        html+=`<li>${d.subject||''} - Marks: ${d.marks||''} - Position: ${d.position||''}</li>`;
      }
    });
    document.getElementById("resultsList").innerHTML=html;
  });

  // Routine (only current student class)
  db.ref("routines").once("value").then(s=>{
    let html="";
    s.forEach(c=>{
      let d=c.val();
      if(d.class===currentUser.class && d.school===currentUser.school){
        html+=`<li>${d.day} - ${d.period} - ${d.subject} - ${d.teacher}</li>`;
      }
    });
    document.getElementById("routineList").innerHTML=html;
  });
}

// section switching
function showSection(id){
  document.querySelectorAll(".card").forEach(c=>c.style.display="none");
  document.getElementById(id).style.display="block";
}

// initial load
showSection('notice');
loadData();
</script>

</body>
  </html>
